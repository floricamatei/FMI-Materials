-- LABORATOR 2

SELECT TO_CHAR(SYSDATE, 'DD/MON/YYYY')
FROM DUAL;

SELECT TO_CHAR(TO_DATE('22-FEB-2023'), 'DD/mon/YYYY')
FROM DUAL;

SELECT TO_NUMBER('-25.789', 99.999)
FROM DUAL;

SELECT INSTR(LOWER('AbC aBcDe'), 'ab', 5, 1)
FROM DUAL;

SELECT RTRIM('infoCXXXXABC', 'CABX')
FROM DUAL;

SELECT NVL(1, 'a') -- EROARE - tipuri de date diferite
FROM DUAL;

SELECT NVL(TO_CHAR(1), 'a')
FROM DUAL; -- conversie explicita

-- EX 2
-- LIKE
SELECT INITCAP(FIRST_NAME) "Prenume", UPPER(LAST_NAME) "Nume",
       LENGTH(LAST_NAME) "Lungime Nume"
FROM EMPLOYEES
WHERE   UPPER(LAST_NAME) LIKE 'J%' 
        OR UPPER(LAST_NAME) LIKE 'M%'
        OR UPPER(LAST_NAME) LIKE '__A%'
ORDER BY "Lungime Nume" DESC;

-- SUBSTR
SELECT INITCAP(FIRST_NAME) "Prenume", UPPER(LAST_NAME) "Nume",
       LENGTH(LAST_NAME) "Lungime Nume"
FROM EMPLOYEES
WHERE   SUBSTR(UPPER(LAST_NAME), 1, 1) = 'J' 
        OR SUBSTR(UPPER(LAST_NAME), 1, 1) = 'M'
        OR SUBSTR(UPPER(LAST_NAME), 3, 1) = 'A'
ORDER BY "Lungime Nume" DESC;


-- EX 4
SELECT EMPLOYEE_ID, LAST_NAME, LENGTH(LAST_NAME),
       INSTR(UPPER(LAST_NAME), 'A') "Prima Aparitie A Lui A"
FROM EMPLOYEES
WHERE SUBSTR(LOWER(LAST_NAME), -1) = 'e';

-- EX 5
SELECT *
FROM EMPLOYEES
WHERE MOD(ROUND(SYSDATE - HIRE_DATE), 7) = 0; 

-- EX 6
SELECT EMPLOYEE_ID, LAST_NAME, SALARY, 
       ROUND(SALARY + 0.15 * SALARY, 2) "Salariu Nou",
       ROUND((SALARY + 0.15 * SALARY) / 100, 2) "Numar Sute"
FROM EMPLOYEES
WHERE MOD(SALARY, 1000) != 0;

-- EX 7
SELECT LAST_NAME AS "Nume Angajat", RPAD(TO_CHAR(HIRE_DATE), 20, 'X') "Data Angajarii"
FROM EMPLOYEES
WHERE COMMISSION_PCT IS NOT NULL;

-- EX 8
SELECT TO_CHAR(SYSDATE + 30, 'MONTH DD YYYY HH24:MI:SS') "Data"
FROM DUAL;

-- EX 9
SELECT ROUND(TO_DATE('31-12-2023', 'DD-MM-YYYY') - SYSDATE) "Zile Pana La Sfarsitul Anului"
FROM DUAL;

-- EX 10
-- a)
SELECT TO_CHAR(SYSDATE + 0.5, 'DD/MM HH24:MI:SS') "Data"
FROM DUAL;

-- b)
SELECT TO_CHAR(SYSDATE + 5 / 60 / 24, 'DD/MM HH24:MI:SS') "Data"
FROM DUAL;

-- EX 11
SELECT CONCAT(LAST_NAME, ' ' || FIRST_NAME), HIRE_DATE,
NEXT_DAY(ADD_MONTHS(HIRE_DATE, 6), 'MONDAY') "Negociere"
FROM EMPLOYEES;

-- EX 12
SELECT LAST_NAME, ROUND(MONTHS_BETWEEN(SYSDATE, HIRE_DATE)) "Luni Lucrate"
FROM EMPLOYEES
ORDER BY "Luni Lucrate";

-- EX 13
SELECT LAST_NAME, NVL(TO_CHAR(COMMISSION_PCT), 'Fara Comision') "Comision"
FROM EMPLOYEES;


SELECT LAST_NAME,
       DECODE(COMMISSION_PCT, NULL, 'Fara Comision', COMMISSION_PCT) "Comision"
FROM EMPLOYEES;

-- EX 14
SELECT LAST_NAME, SALARY, COMMISSION_PCT
FROM EMPLOYEES
WHERE SALARY + SALARY * NVL(COMMISSION_PCT, 0) > 10000;

SELECT LAST_NAME, SALARY, COMMISSION_PCT
FROM EMPLOYEES
WHERE NVL(SALARY + SALARY * COMMISSION_PCT, SALARY) > 10000
ORDER BY COMMISSION_PCT NULLS FIRST;

-- EX 15
SELECT LAST_NAME, JOB_ID, SALARY,
       CASE WHEN JOB_ID = 'IT_PROG' THEN SALARY * 1.1
            WHEN JOB_ID = 'ST_CLERK' THEN SALARY * 1.15
            WHEN JOB_ID = 'SA_REP' THEN SALARY * 1.12
            ELSE SALARY
       END "Salariu Renegociat" 
FROM EMPLOYEES;

-- JOIN

SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME
FROM EMPLOYEES, DEPARTMENTS
WHERE DEPARTMENT_ID = D.DEPARTMENT_ID; -- ambiguitate

-- JOIN IN WHERE
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME, e.DEPARTMENT_ID
FROM EMPLOYEES e, DEPARTMENTS d
WHERE e.DEPARTMENT_ID = d.DEPARTMENT_ID;


-- JOIN IN FROM FOLOSIND ON
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME
FROM EMPLOYEES e JOIN DEPARTMENTS d ON (e.DEPARTMENT_ID = d.DEPARTMENT_ID);


-- JOIN IN FROM FOLOSIND USING
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME
FROM EMPLOYEES JOIN DEPARTMENTS USING (DEPARTMENT_ID);

SELECT * FROM EMPLOYEES-- LABORATOR 2

SELECT TO_CHAR(SYSDATE, 'DD/MON/YYYY')
FROM DUAL;

SELECT TO_CHAR(TO_DATE('22-FEB-2023'), 'DD/mon/YYYY')
FROM DUAL;

SELECT TO_NUMBER('-25.789', 99.999)
FROM DUAL;

SELECT INSTR(LOWER('AbC aBcDe'), 'ab', 5, 1)
FROM DUAL;

SELECT RTRIM('infoCXXXXABC', 'CABX')
FROM DUAL;

SELECT NVL(1, 'a') -- EROARE - tipuri de date diferite
FROM DUAL;

SELECT NVL(TO_CHAR(1), 'a')
FROM DUAL; -- conversie explicita

-- EX 2
-- LIKE
SELECT INITCAP(FIRST_NAME) "Prenume", UPPER(LAST_NAME) "Nume",
       LENGTH(LAST_NAME) "Lungime Nume"
FROM EMPLOYEES
WHERE   UPPER(LAST_NAME) LIKE 'J%' 
        OR UPPER(LAST_NAME) LIKE 'M%'
        OR UPPER(LAST_NAME) LIKE '__A%'
ORDER BY "Lungime Nume" DESC;

-- SUBSTR
SELECT INITCAP(FIRST_NAME) "Prenume", UPPER(LAST_NAME) "Nume",
       LENGTH(LAST_NAME) "Lungime Nume"
FROM EMPLOYEES
WHERE   SUBSTR(UPPER(LAST_NAME), 1, 1) = 'J' 
        OR SUBSTR(UPPER(LAST_NAME), 1, 1) = 'M'
        OR SUBSTR(UPPER(LAST_NAME), 3, 1) = 'A'
ORDER BY "Lungime Nume" DESC;


-- EX 4
SELECT EMPLOYEE_ID, LAST_NAME, LENGTH(LAST_NAME),
       INSTR(UPPER(LAST_NAME), 'A') "Prima Aparitie A Lui A"
FROM EMPLOYEES
WHERE SUBSTR(LOWER(LAST_NAME), -1) = 'e';

-- EX 5
SELECT *
FROM EMPLOYEES
WHERE MOD(ROUND(SYSDATE - HIRE_DATE), 7) = 0; 

-- EX 6
SELECT EMPLOYEE_ID, LAST_NAME, SALARY, 
       ROUND(SALARY + 0.15 * SALARY, 2) "Salariu Nou",
       ROUND((SALARY + 0.15 * SALARY) / 100, 2) "Numar Sute"
FROM EMPLOYEES
WHERE MOD(SALARY, 1000) != 0;

-- EX 7
SELECT LAST_NAME AS "Nume Angajat", RPAD(TO_CHAR(HIRE_DATE), 20, 'X') "Data Angajarii"
FROM EMPLOYEES
WHERE COMMISSION_PCT IS NOT NULL;

-- EX 8
SELECT TO_CHAR(SYSDATE + 30, 'MONTH DD YYYY HH24:MI:SS') "Data"
FROM DUAL;

-- EX 9
SELECT ROUND(TO_DATE('31-12-2023', 'DD-MM-YYYY') - SYSDATE) "Zile Pana La Sfarsitul Anului"
FROM DUAL;

-- EX 10
-- a)
SELECT TO_CHAR(SYSDATE + 0.5, 'DD/MM HH24:MI:SS') "Data"
FROM DUAL;

-- b)
SELECT TO_CHAR(SYSDATE + 5 / 60 / 24, 'DD/MM HH24:MI:SS') "Data"
FROM DUAL;

-- EX 11
SELECT CONCAT(LAST_NAME, ' ' || FIRST_NAME), HIRE_DATE,
NEXT_DAY(ADD_MONTHS(HIRE_DATE, 6), 'MONDAY') "Negociere"
FROM EMPLOYEES;

-- EX 12
SELECT LAST_NAME, ROUND(MONTHS_BETWEEN(SYSDATE, HIRE_DATE)) "Luni Lucrate"
FROM EMPLOYEES
ORDER BY "Luni Lucrate";

-- EX 13
SELECT LAST_NAME, NVL(TO_CHAR(COMMISSION_PCT), 'Fara Comision') "Comision"
FROM EMPLOYEES;


SELECT LAST_NAME,
       DECODE(COMMISSION_PCT, NULL, 'Fara Comision', COMMISSION_PCT) "Comision"
FROM EMPLOYEES;

-- EX 14
SELECT LAST_NAME, SALARY, COMMISSION_PCT
FROM EMPLOYEES
WHERE SALARY + SALARY * NVL(COMMISSION_PCT, 0) > 10000;

SELECT LAST_NAME, SALARY, COMMISSION_PCT
FROM EMPLOYEES
WHERE NVL(SALARY + SALARY * COMMISSION_PCT, SALARY) > 10000
ORDER BY COMMISSION_PCT NULLS FIRST;

-- EX 15
SELECT LAST_NAME, JOB_ID, SALARY,
       CASE WHEN JOB_ID = 'IT_PROG' THEN SALARY * 1.1
            WHEN JOB_ID = 'ST_CLERK' THEN SALARY * 1.15
            WHEN JOB_ID = 'SA_REP' THEN SALARY * 1.12
            ELSE SALARY
       END "Salariu Renegociat" 
FROM EMPLOYEES;


-- JOIN IN WHERE
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME, e.DEPARTMENT_ID
FROM EMPLOYEES e, DEPARTMENTS d
WHERE e.DEPARTMENT_ID = d.DEPARTMENT_ID;


-- JOIN IN FROM FOLOSIND ON
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME
FROM EMPLOYEES e JOIN DEPARTMENTS d ON (e.DEPARTMENT_ID = d.DEPARTMENT_ID);


-- JOIN IN FROM FOLOSIND USING
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME
FROM EMPLOYEES JOIN DEPARTMENTS USING (DEPARTMENT_ID);

-- Afisare angajati fara departament
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME, e.DEPARTMENT_ID
FROM EMPLOYEES e, DEPARTMENTS d
WHERE e.DEPARTMENT_ID = d.DEPARTMENT_ID (+);


-- Afisare departamente fara angajati
SELECT EMPLOYEE_ID, LAST_NAME, DEPARTMENT_NAME, d.DEPARTMENT_ID
FROM EMPLOYEES e, DEPARTMENTS d
WHERE e.DEPARTMENT_ID (+) = d.DEPARTMENT_ID;
